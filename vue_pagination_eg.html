<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vue 分頁範例</title>
    <!-- Bootstarp 5 CSS CDN -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    />
    <style></style>
  </head>
  <body>
    <div id="app">
      <div class="container py-5">
        <h2>Vue 分頁範例</h2>
        <div class="row" id="content">
          <template v-for="item in displayData" :key="item.name">
            <div class="col-md-6 py-2">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title">{{ item.name }}</h5>
                  <h6 class="card-subtitle mb-2 text-body-secondary">
                    {{ item.gender }}
                  </h6>
                </div>
              </div>
            </div>
          </template>
        </div>
        <div class="d-flex justify-content-center mt-4">
          <nav aria-label="Page navigation example">
            <ul class="pagination" id="pageid">
              <li class="page-item">
                <a
                  href="#"
                  @click="changePage(currentPage - 1)"
                  :class="{ disabled: currentPage === 1 }"
                  class="page-link"
                  >Previous</a
                >
              </li>
              <!--當被點擊時changePage會等於被點擊到的值-->
              <li class="page-item" v-for="i in totalPages" :key="i">
                <a
                  href="#"
                  class="page-link"
                  :class="{ active: currentPage === i }"
                  @click="changePage(i)"
                  >{{i}}</a
                >
              </li>
              <!--當cardsPage小於totalPages時，被點擊可以將頁碼加1-->
              <li class="page-item">
                <a
                  href="#"
                  class="page-link"
                  @click="changePage(currentPage + 1)"
                  :class="{ disabled: currentPage === totalPages }"
                  >Next</a
                >
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>

    <!-- Vue 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Bootstrap 5 JS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module">
      const jsonData = [
        {
          name: "田曦薇",
          gender: "女",
        },
        {
          name: "虞書欣",
          gender: "女",
        },
        {
          name: "王鶴棣",
          gender: "男",
        },
        {
          name: "林一",
          gender: "男",
        },
        {
          name: "劉浩存",
          gender: "女",
        },
        {
          name: "陳星旭",
          gender: "男",
        },
        {
          name: "章若楠",
          gender: "女",
        },
      ];
      const app = Vue.createApp({
        // 資料 (函式)
        data() {
          return {
            actorData: [], // 存取抓取到的api資料
            displayData: [], // 暫存的資料
            perPage: 2, // 每一頁只放2筆資料
            currentPage: 1,
            totalPages: 0,
          };
        },
        // 生命週期 (函式)
        created() {
          console.log(this);
          // 使用生命週期觸發
          this.getData();
          this.pagination();
          this.updateData();
        },
        // 方法 (物件)
        methods: {
          getData() {
            this.actorData = jsonData;
          },
          pagination() {
            const dataTotal = this.actorData.length; // 抓取整個資料數量
            console.log(dataTotal);
            this.totalPages = Math.ceil(dataTotal / this.perPage); // 將全部數量除以每頁存方資料，並做無條件進位
          },
          changePage(page) {
            this.currentPage = page;
            this.updateData();
          },
          updateData() {
            // 因為一頁只會顯示20筆資料，所以要把每頁的20筆資料放入新的陣列裡面
            const start = (this.currentPage - 1) * this.perPage;
            const end = start + this.perPage;
            this.displayData = this.actorData.slice(start, end);
          },
        },
      });

      app.mount("#app");
    </script>
  </body>
</html>
