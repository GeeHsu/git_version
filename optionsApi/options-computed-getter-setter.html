<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Computed 運算之 Getter, Setter</title>
    <!-- Bootstarp 5 CSS CDN -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    />
    <style></style>
  </head>
  <body>
    <div id="app">
      <div class="container py-5">
        <h2>Computed 運算之 Getter, Setter</h2>
        <h3>Computed 將目前的數值運算呈現至畫面上</h3>
        <ul>
          <li v-for="product in products">
            {{ product.name }} / {{ product.price }}
            <button type="button" @click="addToCart(product)">
              加入購物車
            </button>
          </li>
        </ul>
        ...
        <h6>購物車項目</h6>
        <ul>
          <li v-for="item in carts">{{ item.name }}</li>
        </ul>
        total 的值: {{ total }} <br />

        <h3>Computed 常見技巧 - 搜尋</h3>
        <input type="search" v-model="search" />
        <ul>
          <li v-for="item in filterProducts">
            {{ item.name }} / {{ item.price }}
          </li>
        </ul>

        <h3>Computed Getter, Setter</h3>
        sum 的值: <br />
        <input type="number" v-model="num" />
        <button type="button" @click="total = num">更新</button>
        <br />
        total 的值: {{ total }} <br />
        sum 的值: {{ sum }}
      </div>
    </div>

    <!-- Vue 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Bootstrap 5 JS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      const app = {
        // 資料 (函式)
        data() {
          return {
            num: 10,
            search: "",
            products: [
              {
                name: "蛋餅",
                price: 30,
                vegan: false,
              },
              {
                name: "飯糰",
                price: 35,
                vegan: false,
              },
              {
                name: "小籠包",
                price: 60,
                vegan: false,
              },
              {
                name: "蘿蔔糕",
                price: 30,
                vegan: true,
              },
            ],
            carts: [],
            sum: 0,
          };
        },
        // 生命週期 (函式)
        created() {
          console.log(this);
        },
        // 運算 (物件)
        computed: {
          // Computed 運算之 Getter, Setter
          // 物件
          total: {
            // 函式
            // 只能讀取
            get() {
              let total = 0;
              this.carts.forEach((item) => {
                total += item.price;
              });
              // 把 total 的結果回傳出來
              // return total;
              return this.sum || total;
            },
            // 寫入
            set(val) {
              console.log(val);
              // this.sum = val * 0.8;
              this.sum = val;
            },
          },
          // Computed 常見技巧 - 搜尋
          // 函式
          filterProducts() {
            return this.products.filter((item) => {
              return item.name.match(this.search);
              // console.log(item);
            });
          },
        },
        // 方法 (物件)
        methods: {
          addToCart(product) {
            this.carts.push(product);
          },
        },
      };

      Vue.createApp(app).mount("#app");
    </script>
  </body>
</html>
