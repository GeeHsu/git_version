<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>擴充插件 plugins</title>
    <!-- Bootstarp 5 CSS CDN -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    />
    <style></style>
  </head>
  <body>
    <div id="app">
      <div class="container py-5">
        <h2>擴充插件 plugins</h2>
        <p>外部套件匯入方式</p>
        <ul>
          <li>載入方式：使用 CDN 或使用 npm</li>
          <li>
            運用方式：<a href="https://www.npmjs.com/package/vue-axios"
              >app.use()</a
            >
            或
            <a
              href="https://vee-validate.logaretm.com/v4/guide/components/validation#field-level-validation"
              >元件的形式載入</a
            >
            啟用。（另有指令等各種 Vue 的語法形式）
          </li>
        </ul>

        <h3>使用外部套件注意事項：</h3>
        <ul>
          <li>需多注意可搭配的版本號</li>
          <li>更新頻率</li>
          <li>使用人數</li>
        </ul>

        <h3>範例：載入 VeeValidate 驗證套件</h3>
        <!-- 1-1. form 改成 v-form -->
        <!-- 1-2. input 改成 v-field -->
        <!-- 2. v-form 加上 v-slot -->

        <v-form @submit="onSubmit" v-slot="{ errors }">
          {{ errors }}

          <!-- 3-1. v-field 會加上規則 -->
          <!-- 3-4. name 也可以自定義名稱 -->
          <v-field
            name="欄位名稱"
            type="text"
            placeholder="Who are you"
            :rules="isRequired"
          ></v-field>
          <!-- 3-5. error-message -->
          <!-- 3-6. 在 error-message 加上 name="欄位名稱" 對應到 v-field -->
          <error-message name="欄位名稱">請填寫此欄位</error-message>

          <button>Submit</button>
        </v-form>

        <p>比對與 ESM 版本上的差異</p>
      </div>
    </div>

    <!-- Vue 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Bootstrap 5 JS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Vee Validate v4 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vee-validate/4.1.17/vee-validate.min.js"></script>
    <script type="module">
      console.log(VeeValidate);
      // VeeValidate CDN 版本
      const app = Vue.createApp({
        components: {
          // Components were renamed to avoid conflicts of HTML form element without a vue compiler
          VForm: VeeValidate.Form,
          VField: VeeValidate.Field,
          ErrorMessage: VeeValidate.ErrorMessage,
        },
        // 方法 (物件)
        methods: {
          onSubmit(value) {
            // 3-7. 在 console 加上數值 1
            // 3-8. 在 onSubmit() 會自動帶上一個參數
            // console.log(1);
            console.log(value);
          },
          // 3-2. 規則會定義在方法裡面，參數會傳入一個值
          isRequired(value) {
            // 3-3. 驗證值有沒有填寫
            if (!value) {
              return "此欄是必填的";
            }
            return true;
          },
        },
      });

      app.mount("#app");
    </script>

    <script>
      // ESM 版本的差異（需要 Webpack）
      // import { Field, Form, ErrorMessage } from 'vee-validate';
      //
      // export default {
      //   components: {
      //     Field,
      //     Form,
      //     ErrorMessage,
      //   },
      //   methods: {
      //     isRequired(value) {
      //       if (value && value.trim()) {
      //         return true;
      //       }
      //
      //       return 'This is required';
      //     },
      //   },
      // };
    </script>
  </body>
</html>
